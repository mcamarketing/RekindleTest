# =============================================================================
# REKINDLE CrewAI Agents Environment Variables
# =============================================================================
# Copy this file to .env and fill in your actual values
# NEVER commit the .env file to git!

# =============================================================================
# REQUIRED VARIABLES (Application will NOT start without these)
# =============================================================================

# Supabase Configuration
# Get these from: https://app.supabase.com/project/_/settings/api
SUPABASE_URL=https://your-project-id.supabase.co
SUPABASE_SERVICE_ROLE_KEY=your_supabase_service_role_key_here

# Supabase JWT Secret
# Get this from: https://app.supabase.com/project/_/settings/api -> JWT Settings
SUPABASE_JWT_SECRET=your_jwt_secret_here

# Anthropic API Key (for Claude AI)
# Get this from: https://console.anthropic.com/settings/keys
ANTHROPIC_API_KEY=your_anthropic_api_key_here

# =============================================================================
# CRITICAL PRODUCTION VARIABLES (P0 - Required for Launch)
# =============================================================================

# OpenAI API Key (for CrewAI agents - BLOCKING)
# Get this from: https://platform.openai.com/api-keys
OPENAI_API_KEY=your_openai_api_key_here

# SendGrid API Key (for email delivery - BLOCKING)
# Get this from: https://app.sendgrid.com/settings/api_keys
SENDGRID_API_KEY=your_sendgrid_api_key_here

# SendGrid From Email (verified sender)
SENDGRID_FROM_EMAIL=noreply@yourdomain.com
SENDGRID_FROM_NAME=Rekindle AI

# SendGrid Webhook Verification Key (REQUIRED for security - Phase 0 Fix #4)
# Get this from: https://app.sendgrid.com/settings/mail_settings (Event Webhook section)
# This prevents webhook spoofing attacks
SENDGRID_WEBHOOK_VERIFICATION_KEY=your_sendgrid_webhook_verification_key_here

# Twilio Credentials (for SMS/WhatsApp - BLOCKING)
# Get these from: https://console.twilio.com/
TWILIO_ACCOUNT_SID=your_twilio_account_sid_here
TWILIO_AUTH_TOKEN=your_twilio_auth_token_here
TWILIO_PHONE_NUMBER=+1234567890

# Stripe API Key (for billing - BLOCKING)
# Get this from: https://dashboard.stripe.com/apikeys
STRIPE_SECRET_KEY=your_stripe_secret_key_here
STRIPE_WEBHOOK_SECRET=your_stripe_webhook_secret_here

# JWT Secret (for token signing - BLOCKING)
# Generate with: python -c "import secrets; print(secrets.token_urlsafe(64))"
JWT_SECRET=your_jwt_secret_here

# =============================================================================
# OPTIONAL VARIABLES
# =============================================================================

# Server Configuration
PORT=8081
ENVIRONMENT=development

# CORS Configuration
ALLOWED_ORIGINS=http://localhost:5173,http://localhost:3000

# Application URL (for OAuth callbacks)
APP_URL=http://localhost:8081

# Calendar Encryption Key (REQUIRED for OAuth - Phase 0 Fix #5)
# Generate with: python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
# This encrypts Google/Microsoft OAuth tokens at rest (GDPR compliance)
CALENDAR_ENCRYPTION_KEY=your_fernet_encryption_key_here

# Optional: Old encryption key for zero-downtime key rotation
# CALENDAR_ENCRYPTION_KEY_OLD=your_old_fernet_key_here

# Google Calendar Integration (optional)
GOOGLE_CALENDAR_CLIENT_ID=your_google_client_id
GOOGLE_CALENDAR_CLIENT_SECRET=your_google_client_secret
GOOGLE_CALENDAR_REDIRECT_URI=http://localhost:8081/calendar/callback

# Microsoft Calendar Integration (optional)
MICROSOFT_CALENDAR_CLIENT_ID=your_microsoft_client_id
MICROSOFT_CALENDAR_CLIENT_SECRET=your_microsoft_client_secret
MICROSOFT_CALENDAR_REDIRECT_URI=http://localhost:8081/calendar/callback

# Redis Configuration (optional, for caching and queue)
REDIS_HOST=127.0.0.1
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_TLS=false

# Sentry Configuration (for monitoring)
SENTRY_DSN=your_sentry_dsn_here
SENTRY_ENVIRONMENT=development

# Rate Limiting
RATE_LIMIT_PER_MINUTE=60
RATE_LIMIT_BURST=120

# =============================================================================
# SETUP INSTRUCTIONS - DAY 1 PRODUCTION LAUNCH
# =============================================================================
#
# HOUR 1: Environment Configuration (6 critical variables)
#
# 1. Copy this file:
#    cp .env.example .env
#
# 2. Get Supabase credentials:
#    - Go to https://app.supabase.com/project/_/settings/api
#    - Copy "Project URL" to SUPABASE_URL
#    - Copy "service_role" key to SUPABASE_SERVICE_ROLE_KEY
#    - Copy "JWT Secret" to SUPABASE_JWT_SECRET
#
# 3. Get Anthropic API key (for Rex chat):
#    - Go to https://console.anthropic.com/settings/keys
#    - Create a new API key
#    - Copy to ANTHROPIC_API_KEY
#
# 4. Get OpenAI API key (for CrewAI agents - CRITICAL):
#    - Go to https://platform.openai.com/api-keys
#    - Create a new API key
#    - Copy to OPENAI_API_KEY
#    - Without this, NO campaigns will execute!
#
# 5. Get SendGrid API key (for email delivery - CRITICAL):
#    - Go to https://app.sendgrid.com/settings/api_keys
#    - Create API key with "Mail Send" permissions
#    - Copy to SENDGRID_API_KEY
#    - Set SENDGRID_FROM_EMAIL to a verified sender
#    - Domain authentication required: https://app.sendgrid.com/settings/sender_auth
#
# 6. Get Twilio credentials (for SMS/WhatsApp - CRITICAL):
#    - Go to https://console.twilio.com/
#    - Copy Account SID to TWILIO_ACCOUNT_SID
#    - Copy Auth Token to TWILIO_AUTH_TOKEN
#    - Buy a phone number and copy to TWILIO_PHONE_NUMBER
#
# 7. Get Stripe API key (for billing - CRITICAL):
#    - Go to https://dashboard.stripe.com/apikeys
#    - Copy "Secret key" to STRIPE_SECRET_KEY
#    - Set up webhook endpoint and copy signing secret to STRIPE_WEBHOOK_SECRET
#
# 8. Generate JWT secret:
#    python -c "import secrets; print(secrets.token_urlsafe(64))"
#    Copy the output to JWT_SECRET
#
# 9. Generate Calendar Encryption Key:
#    python -c "import secrets; print(secrets.token_urlsafe(32))"
#    Copy the output to CALENDAR_ENCRYPTION_KEY
#
# 10. (Optional) Configure Calendar OAuth:
#     - Set up OAuth apps in Google/Microsoft developer console
#     - Add the client IDs, secrets, and redirect URIs
#
# 11. Save and test locally:
#     python api_server.py
#
# HOUR 2-3: Production Deployment
# - Use deploy_production.py script (see below)
# - Or manual Railway/Render deployment (see DEPLOYMENT.md)
#
# =============================================================================
# SECURITY NOTES
# =============================================================================
#
# - NEVER commit .env files to git
# - Service role key grants full database access - keep it secret!
# - JWT secret is used to verify authentication tokens
# - Rotate all keys regularly for better security
# - Use different credentials for development and production
# - Encryption key protects OAuth tokens in database
# - Store production secrets in a secure vault (e.g., AWS Secrets Manager)
#
# =============================================================================
# TROUBLESHOOTING
# =============================================================================
#
# If the server fails to start:
# 1. Check that all REQUIRED variables are set
# 2. Verify Supabase credentials are correct
# 3. Test Anthropic API key: https://console.anthropic.com/settings/keys
# 4. Check logs for specific error messages
#
